<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Donor Dashboard | Blood Bank</title>
<style>
body {
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background: #fff5f5;
    margin: 0;
    padding: 0;
}
header {
    background: rgb(172, 5, 5);
    color: white;
    padding: 1rem;
    text-align: center;
}
.container {
    max-width: 800px;
    background: white;
    margin: 30px auto;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
h2 { color: rgb(172, 5, 5); }
.info {
    margin-top: 20px;
    line-height: 1.8;
}
input[type="date"] {
    padding: 0.6rem;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: 200px;
    margin-right: 10px;
}
button {
    padding: 0.6rem 1rem;
    background: rgb(172, 5, 5);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
button:hover { background: #a00000; }
.logout {
    text-align: right;
    margin-top: 20px;
}
.success {
    background:#e6ffe6; 
    color:green; 
    padding:10px; 
    border-radius:5px; 
    margin-bottom: 15px;
}
</style>
</head>
<body>
<header>
    <h1>Donor Dashboard</h1>
</header>

<div class="container">
    <h2>Welcome, {{ donor.user.username }}!</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="success">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <div class="info">
        <p><strong>Blood Group:</strong> {{ donor.blood_group }}</p>
        <p><strong>Phone:</strong> {{ donor.phone }}</p>
        <p><strong>Gender:</strong> {{ donor.gender }}</p>
        <p><strong>Address:</strong> {{ donor.address }}</p>
        <p><strong>Age:</strong> {{ donor.age }}</p>
        <p><strong>Last Donation:</strong> {{ donor.last_donation_date|default:"Never" }}</p>
        <p><strong>Available to Donate:</strong> 
            {% if donor.available %}
                <strong style="color: green;">Yes! ðŸŽ‰</strong>
            {% else %}
                <strong style="color: orange;">No (Must wait 90 days from last donation)</strong>
            {% endif %}
        </p>
    </div>

    <hr style="margin: 30px 0;">

    <h3>Update Donation Status</h3>
    
    <form method="POST">
        {% csrf_token %}
        <p style="display: flex; align-items: center; gap: 10px;">
            <label for="{{ form.last_donation_date.id_for_label }}"><strong>Last Donation Date:</strong></label>
            {{ form.last_donation_date }}
            <button type="submit">Update Date</button>
        </p>
        <small style="display: block; color: #666; margin-top: 5px;">Update this date after a donation to recalculate your availability (must be at least 90 days apart).</small>
    </form>
    
    <div class="logout">
        <form method="POST" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit">Logout</button>
        </form>
    </div>
</div>
</body>
</html>